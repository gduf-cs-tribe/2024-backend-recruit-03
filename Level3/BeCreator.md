# 2024-backend-recruit-03-Level3

# BeCreator

# 目录

**本考核内容针对学习C++/go的同学设计**

## 考核要求

1. **强制**使用git进行版本控制，并且push到github或gitee
   - 仓库必须设置为公开仓库
   - 在编码过程中需要逐步commit，并书写规范的commit message
   - 建议使用issue记录工作进度、需求和规划(非强制)

2. 仓库中**必须**包含详细的README，内容包括：
   - 开发和运行环境要求
   - 快速开始指南
   - 项目说明
   - 关键功能说明
   - 使用示例

3. 代码规范
   - **必须**使用UTF-8编码
   - 遵循语言规范的命名约定
   - 包含完整的注释说明

## 涉及技术关键字

1. Socket网络编程
2. 多线程/协程
3. 文件I/O操作
4. 内存管理(C++)
5. 错误处理
6. Reactor模型**功能要求**

## 项目介绍

在完成了第二轮考核的基础KV存储后，小爪希望你能帮他优化一下程序的性能和功能。主要需要：

1. 提高并发处理能力
2. 实现可靠的数据持久化
3. 添加更多实用功能

## 基本内容及功能

### 1. 网络层
- 使用Socket实现服务端和客户端通信
- 实现多线程/协程处理并发连接
- 支持优雅关闭服务

### 2. 存储引擎核心
- 支持第二轮所有基础命令(除help外)
- 实现简单的缓存淘汰策略(如FIFO)
- 支持数据持久化

### 3. 持久化机制
实现以下两种方式之一:
- 追加日志文件
  - 记录所有修改操作
  - 支持数据恢复
- 数据快照
  - 支持全量数据保存
  - 支持数据恢复

### 4. 日志框架
- **必须**使用日志框架(如spdlog/zap等)
- 日志级别区分(INFO/WARN/ERROR等)
- 日志文件自动分割和保存
- 记录关键操作和错误信息

### 5. 命令支持
#### 5.1 持久化相关命令
- SAVE - 手动强制数据持久化
- BGSAVE - 后台异步数据持久化
- FLUSHDB - 清空缓存(支持sync/async两种模式)

#### 5.2 过期机制命令
- EXPIRE [key] [delay] - 设置key的过期时间(秒)
- DDL [key] - 查看key的剩余过期时间

#### 5.3 集合操作命令
- SADD [key] [member1] [member2] ... - 向集合添加成员
- SMEMBERS [key] - 查看集合所有成员
- SISMEMBER [key] [member] - 判断元素是否为集合成员
- SREM [key] [member] - 删除集合成员

### 6. 配置管理
- 使用配置文件管理系统参数
- 支持的配置项包括:
  - 服务器端口号
  - 持久化文件存储位置
  - 日志文件存储位置
  - 持久化方式选择
  - 日志级别设置
  - 最大连接数限制
  - 缓存淘汰策略

### 7. 日志记录
- 记录基本的运行日志
  - 启动/关闭信息
  - 错误信息
  - 操作记录

## 高级功能(可选,完成部分即可)

1. 数据备份
   - 支持数据文件备份
   - 定期自动备份
2. 简单的监控
   - 记录连接数
   - 记录操作次数
   - 记录内存使用
3. 安全机制
   - 简单的访问控制
   - 错误请求处理
4. 在软件关闭前，再做一次持久化。
5. 能标识错误，并且在程序中进行了处理，例如HTTP协议中的400状态码和500状态码。
6. 能够做出一套该kv数据库的API供其他程序使用。
7. 自定义请求报文和响应报文。（这部分必须把报文格式写在项目文档中）
8. 添加用户系统与命名空间机制，且每个用户都将被分配一个独立的命名空间。不同用户在各自命名空间中操作的数据互不影响。系统应能同时支持多个用户之间的操作，操作之间互不干扰。

## 考核建议

1. 请先思考好整体架构，不要盲目开始敲代码，要考虑到代码的优雅和健壮性。
   
2. 每个指令都要有相应的响应值。
3. 在服务端的控制台可以打印相应的日志数据以便debug等。
4. 客户端界面不用美观，简单的命令行就好，只要能有提示输入的作用就行。
5. 编码要求：要求分文件写，不能全部写在同一个文件里
6. 代码注释务必写好。标明每一个方法的作用、变量的作用等等

## 语言特定建议

### C++
- 合理使用STL容器
- 注意内存管理
- 使用智能指针
- 避免内存泄漏

### Go
- 合理使用goroutine
- 正确使用channel
- 使用defer清理资源
- 处理好错误返回

## 加分项:
- 完整的测试用例
- 详细的文档说明
- 良好的代码风格

